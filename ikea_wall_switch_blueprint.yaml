blueprint:
  name: ZHA - IKEA Tradfri wall switch
  description: |
    Control lights or anything else using IKEA Tradfri wall switch.

    You can specify individual actions for On/Off/Hold On/Hold Off,
    or configure long presses.
  domain: automation
  input:
    remote1:
      name: On/Off Switch
      description: IKEA switch to use
      default:
      selector:
        device:
          integration: zha
          manufacturer: 'IKEA of Sweden'
    button_on_short:
      name: On button press
      description: Action to run on press of On button
      default: []
      selector:
        action:
    button_off_short:
      name: Off button press
      description: Action to run on press of Off button
      default: []
      selector:
        action:
    button_on_long:
      name: On button hold
      description: Action to run on long press of On button
      default: []
      selector:
        action:
    button_off_long:
      name: Off button hold
      description: Action to run on long press of Off button
      default: []
      selector:
        action:
trigger:
- platform: event
  event_type: zha_event
  event_data:
    device_id: !input remote1
mode: restart

action:
- variables:
    command: "{{ trigger.event.data.command }}"
    cluster_id: "{{ trigger.event.data.cluster_id }}"
    endpoint_id: "{{ trigger.event.data.endpoint_id }}"
    args: "{{ trigger.event.data.args }}"
- choose:
  - conditions:
    - "{{ command == 'on' }}"
    - "{{ cluster_id == 6 }}"
    - "{{ endpoint_id == 1 }}"
    sequence: !input 'button_on_short'
  - conditions:
    - "{{ command == 'off' }}"
    - "{{ cluster_id == 6 }}"
    - "{{ endpoint_id == 1 }}"
    sequence: !input 'button_off_short'
  - conditions:
    - "{{ command == 'move_with_on_off' }}"
    - "{{ cluster_id == 8 }}"
    - "{{ endpoint_id == 1 }}"
    sequence: !input 'button_on_long'
  - conditions:
    - "{{ command == 'move' }}"
    - "{{ cluster_id == 8 }}"
    - "{{ endpoint_id == 1 }}"
    sequence: !input 'button_off_long'